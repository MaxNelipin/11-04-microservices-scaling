# 11-04-microservices-scaling

## Задача 1: Кластеризация

Предложите решение для обеспечения развертывания, запуска и управления приложениями.
Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Я бы взял Kubernetes, чтобы не получить проблемы в совместивости при обновлении той или иной части системы управления всей инфраструктурой.

Решение должно соответствовать следующим требованиям:
- Поддержка контейнеров; - Есть, Docker
- Обеспечивать обнаружение сервисов и маршрутизацию запросов; 

     - Обнаружение:
     
     Сервисы в Kubernetes предоставляют доступ к экземплярам вашего работающего в кластере микросервиса или приложения через сетевой порт. Найти адрес сервиса удобнее всего через обнаружение имен DNS. Сервис Kubernetes использует специальные настройки внутренней сети кластера, прокси-компонент kube-proxy, и виртуальные IP-адреса, чтобы обеспечить прозрачный доступ к динамичному, имеющему склонность к постоянным обновления и перезапускам развертыванию Deployment. Внутренняя реализация сервисов позволяет прозрачно работать с любым количеством экземпляров ваших микросервисов и включает в себя простые алгоритмы балансировки нагрузки. Для поиска экземпляров используются метки labels.
     
   - Маршрутизация: 
   
   Балансировщик Ingress(это особые ресурсы, которые позволяют гибко настраивать балансировщики нагрузки: расшифровку TLS-трафика, виртуальные хосты, маршрутизацию, основанную на путях) + kube-proxy, который  взаимодействует с модулем ядра Linux netfilter для перехвата и перенаправления трафика, отправленного на IP кластера, на работающий под + NodePort для переключения при недоступности порта Pod. 
  https://habr.com/ru/company/ruvds/blog/442646/
  
- Обеспечивать возможность горизонтального масштабирования; 

HPA масштабирует количество реплик pod'ов. В качестве триггеров для изменения количества реплик большинство девопсов используют нагрузку на процессор и память. Однако можно масштабировать систему на основе пользовательских метрик, их сочетания или даже внешних метрик.
Высокоуровневая схема работы HPA:
HPA непрерывно проверяет значения метрик, указанные при установке, с интервалом по умолчанию 30 секунд.
HPA пытается увеличить количество модулей, если достигнут заданный порог.
HPA обновляет количество реплик внутри контроллера развертывания/репликации.
Контроллер развертывания/репликации затем разворачивает все необходимые дополнительные модули.
HPA запускает процесс развертывания модулей при достижении порогового значения метрик

- Обеспечивать возможность автоматического масштабирования;  - Да, см.выше

- Обеспечивать явное разделение ресурсов доступных извне и внутри системы; - Да, изоляция на основе kube-proxy и маршрутизации

   ![image](https://user-images.githubusercontent.com/83664359/156895754-96d5a9f3-af1f-4969-aefd-804e0bd09e9b.png)

- Обеспечивать возможность конфигурировать приложения с помощью переменных среды, в том числе с возможностью безопасного хранения чувствительных данных таких как пароли, ключи доступа, ключи шифрования и т.п. 

  Пароли хранятся в secrets https://kubernetes.io/docs/concepts/configuration/secret/ , 
  
  Переменные среды присуствуют, можно добавлять в свою конфигурацию   https://kubernetes.io/docs/tasks/inject-data-application/define-environment-variable-container/






